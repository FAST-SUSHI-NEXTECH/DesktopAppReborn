<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulaire Prérempli avec JS</title>
  <!-- Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
  <h2 id="titre">Gestion de la commande n°</h2>
  <form id="updateUser" typeof="Form">
    <div class="form-group">
      <label for="id_client">id_client :</label>
      <input class="form-control" id="id_client"></input>
    </div>
    <div class="form-group">
      <label for="id_picker">id_picker :</label>
      <input type="text" class="form-control" id="id_picker">
    </div>
    <div class="form-group">
      <label for="order_state">order_state :</label>
      <input type="text" class="form-control" id="order_state">
    </div>
    <div class="form-group">
      <label for="date">date :</label>
      <input type="text" class="form-control" id="date">
    </div>
    <button type="submit" class="btn btn-primary">Modifier</button>
    <button type="button" class="btn btn-secondary" id="Content">Content</button>
    <button type="button" class="btn btn-secondary"><a href="./home.html" class="text-dark">Retour</a></button>
  </form>
</div>

<!-- Bootstrap JS (optional) -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

<button type="button" class="btn btn-secondary" id="contentButton">Content</button>

<script>
  // Get the id value from the URL
  const urlParams = new URLSearchParams(window.location.search);
  const id = urlParams.get('id');

  // Add event listener to the button
  document.getElementById("Content").addEventListener("click", function() {
    window.location.href = "./ordercontent.html?id=" + id;
  });
</script>


<script type="module">
  import {getOrderByID} from "../../script/getOrderByID.js";

  // Récupérer les paramètres de l'URL
  const queryString = window.location.search;
  const urlParams = new URLSearchParams(queryString);

  // Récupérer la valeur de l'ID
  const id = urlParams.get('id');

  document.addEventListener("DOMContentLoaded", function () {
    // Supposons que vous ayez récupéré des données JSON et que vous les avez stockées dans un tableau JavaScript
    getOrderByID(id).then(function(PromiseResult) {
      // Créer un tableau contenant les données
      const data = [PromiseResult];

      // Récupérer l'élément tbody du tableau
      const tbody = document.getElementById("table-body");

      console.log(data[0][0]);

      var id_order = data[0][0].id_order
      var id_client = data[0][0].id_client;
      var id_picker = data[0][0].id_picker;
      var order_state = data[0][0].order_state;
      var date = data[0][0].date;

      // Récupérer l'élément h2
      var titreFormulaire = document.getElementById("titre");

      // Ajouter le texte de la variable à l'élément h2
      titreFormulaire.innerText += " " + id_order;

      // Remplissage des champs du formulaire avec les valeurs par défaut
      document.getElementById("id_client").value = id_client;
      document.getElementById("id_picker").value = id_picker;
      document.getElementById("order_state").value = order_state;
      document.getElementById("date").value = date;
    }).catch(function(error) {
      console.error("Une erreur s'est produite lors de la récupération des données :", error);
    });
  });

</script>

<!--<script type="module">-->
<!--  import {getOrderContent} from "../../script/getOrderContent.js";-->

<!--  // Récupérer les paramètres de l'URL-->
<!--  const queryString = window.location.search;-->
<!--  const urlParams = new URLSearchParams(queryString);-->

<!--  // Récupérer la valeur de l'ID-->
<!--  const id = urlParams.get('id');-->

<!--  document.addEventListener("DOMContentLoaded", function () {-->
<!--    // Supposons que vous ayez récupéré des données JSON et que vous les avez stockées dans un tableau JavaScript-->
<!--    getOrderContent(id).then(function(data) {-->

<!--      // Récupérer l'élément tbody du tableau-->
<!--      const tbody = document.getElementById("table-body");-->

<!--      // Boucler à travers les propriétés de l'objet JavaScript et les ajouter au tableau-->
<!--      for (const key in data) {-->
<!--        if (data.hasOwnProperty(key)) {-->
<!--          const item = data[key];-->
<!--          let quantity;-->
<!--          if (item.quantity == null) {-->
<!--            quantity = 1;-->
<!--          } else {-->
<!--            quantity = item.quantity;-->
<!--          }-->
<!--          const row = document.createElement("tr");-->
<!--          row.innerHTML = "<td>" + item.id_product + "</td><td>" + item.type_product + "</td><td>" + item.product_name + "</td><td>" + item.price + "</td><td>" + quantity + "</td><td><a href='ordercontent.html?id=' + id></a>Content</td>";-->

<!--          console.log(typeof(row));-->
<!--          console.log(typeof(tbody));-->

<!--          if (!tbody) {-->
<!--            console.error("L'élément avec l'ID 'table-body' n'a pas été trouvé dans le document.");-->
<!--          } else {-->
<!--            tbody.appendChild(row);-->
<!--          }-->
<!--        }-->
<!--      }-->
<!--    }).catch(function(error) {-->
<!--      console.error("Une erreur s'est produite lors de la récupération des données :", error);-->
<!--    });-->
<!--  });-->
<!--</script>-->


</body>
</html>